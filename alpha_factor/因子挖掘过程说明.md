一、数据预处理：为因子挖掘奠定可靠基础

1. 原始数据与统一处理

本研究使用的是**真实股票 OHLCV（开高低收成交量）及成交额（amount）构成的时间序列数据**。在因子构建之前，首先对原始数据进行了统一的预处理与标准化，具体包括：

* 将时间字段统一命名为 `date`，并按时间顺序进行升序排列；
* 对可能影响统计稳定性的异常情况进行处理：

  * 当成交量为 0 时，避免在 VWAP 等指标计算中出现除零错误；
  * 将无穷大（`inf`、`-inf`）统一转换为缺失值（`NaN`）；

上述处理确保了因子计算结果在统计意义上的**可靠性、一致性与可复现性**，为后续因子挖掘提供了干净的数据基础。

2. 严格避免未来函数与数据泄漏

在量化因子研究中，避免未来函数（look-ahead bias）是最基本且最关键的原则之一。为此，本文采用如下处理方式：

该流程的核心思想在于：

* **先对样本时间进行截断**，仅保留研究期内可获得的数据；
* **在截断后的样本上计算未来 5 日收益率**作为预测目标；
* 对未来收益无法计算的样本进行剔除。

由此保证：

> 因子仅使用当期可观测信息构建，而预测目标完全来自未来收益。

该步骤从方法论上严格杜绝了数据泄漏问题，是合格量化研究必须满足的硬性要求。

二、候选 Alpha 因子池构建：基于金融直觉与市场结构

本文并未依赖单一因子进行分析，而是构建了一个**结构清晰、来源多元的候选 alpha 因子池**，所有因子均源自基础行情数据，具备可交易性。

1. 动量与均线类因子

* 短中期收益率：`ret_5`、`ret_10`、`ret_20`
* 移动平均线：`ma_5`、`ma_20`
* 均线差与斜率：`ma_5_20_diff`、`ma_slope`

该类因子主要刻画价格趋势及短期动量特征。

2. 技术指标类因子

* 相对强弱指标：`RSI(14)`
* 趋势与动量指标：`MACD(dif, dea, macd)`

用于反映市场的超买超卖状态及趋势变化。

3. 波动率类因子

* 短中期历史波动率：`volatility_10`、`volatility_20`
* 高低价振幅比例：`hl_vol`

用于刻画市场不确定性及情绪强度。

4. 量价关系因子

* 收盘价相对 VWAP 偏离：`price_vwap_diff`
* 成交量变化率：`vol_roc_5`
* 能量潮指标：`OBV`

该类因子反映价格变化与成交行为之间的关系。

5. K 线结构因子

* 实体长度
* 上下影线长度及其比例

用于刻画日内交易结构及多空力量对比。



> 所有候选因子均仅依赖 OHLCV 与成交额数据，不涉及任何不可交易或事后信息，符合实证资产定价与量化投资研究的基本要求。



# 三、因子筛选方法：基于信息系数（IC）的系统评估

## 1. 采用 IC 的原因

本文采用信息系数（Information Coefficient, IC）作为因子有效性的核心评估指标，包括：

* **Pearson IC**：衡量因子与未来收益之间的线性相关关系；
* **Spearman IC**：衡量二者之间的排序相关关系，更具稳健性。

```python
pearson_ic = corr(factor, future_ret_5)
spearman_ic = corr(factor, future_ret_5, method="spearman")
```

并以 **Spearman IC 的绝对值** 作为主要排序依据，用于筛选具有稳定预测能力的因子。

从本质上看，该方法回答的问题是：

> 当前因子的横向排序，是否能够有效预测未来收益的排序？

这正是 alpha 因子的核心定义。



## 2. IC 排名与因子筛选结果

通过对候选因子进行 IC 计算与排序，最终选取出如下表现最优的因子：

* `price_vwap_diff`
* `ma_5`
* `ma_20`
* `volatility_10`
* `volatility_20`
* `hl_vol`
* `upper_shadow`
* `lower_ratio`

这些因子在样本内表现出：

* IC 值稳定且方向明确；
* 排序预测能力显著；
* 不依赖单一极端样本。


# 四、因子有效性验证

为了避免“仅凭 IC 判断因子有效性”的片面性，本文进一步从收益角度和时间稳定性两个维度进行验证。

## 1. 因子分层收益检验

将样本按因子值划分为 5 个分位组，比较最高分组与最低分组的未来 5 日平均收益。

若因子有效，应当观察到：

* 分层收益具有良好的单调性；
* Long–Short（最高组 − 最低组）组合具备正期望收益。

实证结果表明，核心因子均满足上述特征。



## 2. 滚动 IC 稳定性分析

在 `factor_report.py` 中，进一步计算了 **120 日滚动 Spearman IC**，并绘制：

* IC 时间序列；
* 因子 Long–Short 累计收益曲线。

该分析用于检验因子是否仅在局部时间段内偶然有效。结果显示，核心因子在较长时间窗口内保持了相对稳定的预测能力。


# 五、Alpha 因子的经济含义分析

从整体结果来看，筛选出的 alpha 因子在经济含义上高度一致，均指向同一种市场机制：

## **均值回归与情绪反转效应**

代表性解释如下：

* **price_vwap_diff**
  当价格显著低于成交均价（VWAP）时，往往反映短期情绪过度悲观或流动性冲击，随后价格出现修复。
* **ma_5 / ma_20**
  价格偏离短中期均线较远时，超跌反弹概率显著提升。
* **volatility_10 / volatility_20**
  波动率急剧上升通常对应市场情绪极端状态，随后更容易发生反向修正。



# 六、总结

> 本研究基于真实历史行情数据，构建了由价格、成交量、波动率及 K 线结构组成的候选因子池。在严格避免未来函数的前提下，采用信息系数（IC）方法对因子进行系统筛选，并通过分层收益与滚动 IC 对其有效性进行验证。实证结果表明，所选 alpha 因子主要刻画了价格相对均值的偏离及市场情绪的极端状态，能够在统计意义上稳定预测未来 5 日收益，体现出显著的均值回归与情绪反转特征。

